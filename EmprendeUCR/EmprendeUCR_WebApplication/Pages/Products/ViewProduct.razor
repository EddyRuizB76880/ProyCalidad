@page "/ViewProduct"
@page "/ViewProduct/{CodeId}"
@using EmprendeUCR_WebApplication.Data.Services
@using EmprendeUCR_WebApplication.Data.Entities
@using System.IO
@using BlazorInputFile
@using Syncfusion.Blazor.TreeGrid;
@inject NavigationManager NavigationManager
@inject Product_ServiceService Product_ServiceService
@inject ProductService ProductService
@inject CategoryService CategoryService
@inject Product_PhotosService Product_PhotosService
@inject Blazored.SessionStorage.ISessionStorageService sessionStorage

<body>

    <div class="">
        <!--Displays the header-->
        <section class=" w-100 gap-lg-2">
            <div class="grid2 gap-3">
                <div class=" border-1 shadow  bg-silver">
                    <div class="form-group w-70">
                        <label for="Name" class="control-label m-lg-2">Nombre:</label>
                        <label for="Name" class="control-label">@_product.Product_Name</label>
                    </div><br />
                    <div class="form-group w-30">
                        <label for="Price" class="control-label m-lg-2">Categoria:</label>
                        <label for="Price" class="control-label ">@CategoryService.getCategory(_product.Category_ID).Title</label>
                    </div>
                    <div class="form-group w-70">
                        <label for="Product_Description" class="control-label m-lg-2">Descripción:</label>
                        <textarea readonly="readonly" rows="3" form="Product_Description" class="form-control m-lg-2">@_product.Product_Description</textarea>

                    </div><br />
                    <div class="form-group w-30">
                        <label for="Price" class="control-label m-lg-2">Precio(CRC):</label>
                        <label for="Price" class="control-label ">@_product.Price</label>
                    </div>


                </div>

                <EmprendeUCR_WebApplication.Pages.Product_Service.Product.ProductStatusInput />

            </div> <br /> <br />

            <div>
                <div class="wrapper w-90">
                    @foreach (var prodPhoto in photosDisplay)
                    {
                        <div class="one">
                            <label class="" for="addPhoto1">
                                @if (prodPhoto != null)
                                {
                                    <img src="@Product_PhotosService.convertImageDisplay(prodPhoto.Photos)" width="200" class=" img-card mt-2" />
                                }
                            </label>
                        </div>
                    }
                </div>
            </div>





            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault">
                <label class="form-check-label" for="flexSwitchCheckDefault">Disponibilidad</label>
            </div>

            <div class="row">
                <div class="col-md-4">
                    <div class="form-group">
                        <input type="button" class="btn btn-primary" value="Regresar" />


                    </div>
                </div>
            </div>

        </section>

    </div>
</body>

@functions {
    [Parameter]
    public string CodeId { get; set; }
}

@code {

    Product _product = new Product();
    Product_Photos _prodPhoto = new Product_Photos();
    IList<Product_Photos> photosDisplay;

    public void c(string CodeId)
    {
        loadProduct(CodeId);
    }

    public void loadProduct(string CodeId)
    {
        _product = ProductService.GetProduct(CodeId);
    }

    protected override async Task OnInitializedAsync()
    {
        loadProduct(CodeId);
        loadPhotos(int.Parse(CodeId));
    }

    public void loadPhotos(int CodeId)
    {
        photosDisplay = Product_PhotosService.loadPhotosByID(CodeId);
    }
}
